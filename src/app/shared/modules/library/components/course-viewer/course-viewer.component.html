<ng-container *ngIf="course">
	<mat-drawer-container
		class="h-full w-full"
		autosize
		*ngIf="course.order < 3 || hasValidSubscription; else unauthorizedLesson">
		<mat-drawer
			#drawer
			class="w-60 p-4 !flex flex-col justify-start items-start"
			mode="side"
			opened>
			<h2 class="text-2xl text-primary">Semaine {{ course.order + 1 }}</h2>
			<mat-chip-listbox class="mb-2" aria-label="File selection">
				<mat-chip-option
					*ngFor="let phoneme of course.phonemes"
					selectable="false"
					color="primary">
					{{ phoneme.name }}
				</mat-chip-option>
			</mat-chip-listbox>
			<app-button
				*ngIf="currentLessonIndex < course.order; else completedCourse"
				type="raised"
				color="primary"
				(click)="completeLesson()"
				label="modules.library.mark_as_finished">
			</app-button>
			<ng-template #completedCourse> Leçon terminée </ng-template>

			<hr class="mb-6 mt-3" />

			<h3 class="text-xl">Liste des mots</h3>
			<mat-chip-listbox
				*ngIf="course.words?.length; else noWordsAssociated"
				class="mb-2"
				aria-label="File selection">
				<mat-chip-option
					*ngFor="let word of course.words"
					selectable="false"
					color="primary">
					{{ word }}
				</mat-chip-option>
			</mat-chip-listbox>
			<ng-template #noWordsAssociated>
				<small>Aucun mot associé à cette semaine</small>
			</ng-template>
			<hr class="mb-6 mt-3" />
			<h3 class="text-xl">Liste des fichiers</h3>
			<mat-selection-list #files [multiple]="false">
				<mat-list-option
					*ngFor="let file of filesAvailable"
					[value]="file"
					[selected]="file === filesAvailable[0]">
					{{ 'modules.library.files.' + file | translate }}
				</mat-list-option>
			</mat-selection-list>
			<span class="flex-1"></span>
		</mat-drawer>
		<app-file-viewer
			*ngIf="files.selectedOptions.selected[0] as selectedFile"
			[file]="[course.order, selectedFile.value].join('/')" />
	</mat-drawer-container>
	<ng-template #unauthorizedLesson>
		<app-card
			class="mt-6 max-w-sm"
			title="Accès non autorisé"
			subtitle="Cette leçon n'est accessible uniquement pour les membres abonnés! Pour accéder à cette leçon, abonnez-vous !">
			<app-button type="raised" class="mt-3">Voir l'abonnement</app-button>
		</app-card>
		<p></p>
	</ng-template>
</ng-container>
