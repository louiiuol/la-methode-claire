<!-- <app-button
	[disabled]="loading()"
	type="raised"
	color="primary"
	matTooltip="Si un problème est détecté concernant la librairie, il est possible de la re-générer."
	label="Rafraîchir la bibliothèque"
	(click)="refresh()" />
<ng-template #loadingTemplate>
	<app-loader />
</ng-template> -->

@if (lessons$ | async; as lessons) {
<mat-sidenav-container>
	<mat-sidenav
		#sidenav
		class="max-w-md"
		mode="over"
		[opened]="selectedLesson"
		position="end">
		@if(selectedLesson) {
		<header class="flex w-full justify-between px-4 py-2">
			<h3 class="text-xl text-primary text-center py-3">
				Mise à jour de la leçon N° {{selectedLesson.order + 1}}
			</h3>
			<button
				(click)="sidenav.close()"
				mat-icon-button
				aria-label="close sidenav"
				color="warn">
				<app-icon>close</app-icon>
			</button>
		</header>
		<app-course-edit [course]="selectedLesson" />
		}
	</mat-sidenav>
	<mat-sidenav-content>
		<section class="mat-elevation-z4 overflow-auto" style="max-height: 80vh">
			<table
				mat-table
				aria-describedby="Tableau des leçons de la méthode"
				[dataSource]="lessons"
				class="w-fit !min-w-fit mx-auto mb-9">
				<!-- Position Column -->
				<ng-container matColumnDef="index" [sticky]="true">
					<th mat-header-cell *matHeaderCellDef class="font-bold">
						Semaine / Leçon
					</th>
					<td
						mat-cell
						*matCellDef="let element"
						[style]="{color: element.color}"
						class="!text-center font-bold">
						<div class="flex items-center">
							<app-icon class="cursor-move">drag_handle</app-icon>
							{{element.order + 1}}
						</div>
					</td>
				</ng-container>
				<!-- Name Column -->
				<ng-container matColumnDef="name">
					<th mat-header-cell *matHeaderCellDef class="font-bold">
						Graphème(s)
					</th>
					<td
						mat-cell
						*matCellDef="let element"
						class="text-lg"
						[style]="{color: element.color}">
						@for (phoneme of element.phonemes; track phoneme) {
						<span class="px-2">
							@if (phoneme.endOfWord) {
							<span>-</span>
							} {{phoneme.name | uppercase}} @if (phoneme.sounds; as sounds) {
							@for (sound of sounds; track sound) {
							<span class="px-1 text-xs"> [{{ sound }}] </span>
							} } @if (phoneme.info) {
							<span class="pl-1 text-xs"> ({{ phoneme.info }}) </span>
							}
						</span>
						}
					</td>
				</ng-container>
				<!-- Script Column -->
				<ng-container matColumnDef="script">
					<th mat-header-cell *matHeaderCellDef class="font-bold">Script</th>
					<td
						mat-cell
						*matCellDef="let element"
						[style]="{color: element.color}"
						class="!text-center font-bold">
						{{element.script ? '✔️' : '❌'}}
					</td>
				</ng-container>
				<!-- Lesson Column -->
				<ng-container matColumnDef="lesson">
					<th mat-header-cell *matHeaderCellDef class="font-bold">Leçon</th>
					<td
						mat-cell
						*matCellDef="let element"
						[style]="{color: element.color}"
						class="!text-center font-bold">
						{{element.lesson ? '✔️' : '❌'}}
					</td>
				</ng-container>
				<!-- Exercice Column -->
				<ng-container matColumnDef="exercice">
					<th mat-header-cell *matHeaderCellDef class="font-bold">Exercices</th>
					<td
						mat-cell
						*matCellDef="let element"
						[style]="{color: element.color}"
						class="!text-center font-bold">
						{{element.exercice ? '✔️' : '❌'}}
					</td>
				</ng-container>
				<!-- Poster Column -->
				<ng-container matColumnDef="poster">
					<th mat-header-cell *matHeaderCellDef class="font-bold">Affiche</th>
					<td
						mat-cell
						*matCellDef="let element"
						[style]="{color: element.color}"
						class="!text-center font-bold">
						{{element.poster ? '✔️' : '❌'}}
					</td>
				</ng-container>

				<!-- Edit Column -->
				<ng-container matColumnDef="edit" [stickyEnd]="true">
					<th mat-header-cell *matHeaderCellDef class="font-bold">Modifier</th>
					<td mat-cell *matCellDef="let element" class="!text-center font-bold">
						<app-button type="icon" (click)="editCourse(element)">
							<app-icon color="primary">edit</app-icon>
						</app-button>
					</td>
				</ng-container>
				<tr
					mat-header-row
					*matHeaderRowDef="displayedColumns; sticky: true"></tr>
				<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
			</table>
		</section>
	</mat-sidenav-content>
</mat-sidenav-container>

}
